\section{Partial compact quantum groups}

We generalize Hayashi's definition of a compact quantum group of face type \cite{Hay1} to the case where the commutative base algebra is no longer finite-dimensional. We will present two approaches, based on \emph{partial bialgebras} and \emph{weak multiplier bialgebras} \cite{Boh1}. The first approach is piecewise and concrete, but requires some bookkeeping. The second approach is global but more abstract. As we will see from the general theory and the concrete examples, both approaches have their intrinsic value.

Let $I$ be a set. We consider $I^2=I\times I$ as the pair groupoid with $\wmult$ denoting composition. That is, an element $K=(k,l)\in I^2$ has source $K_l = k$ and target $K_r=l$, and if $K=(k,l)$ and $L=(l,m)$ we write $K\wmult L = (k,m)$. 

\begin{Def} A \emph{partial algebra} $\mathscr{A}=(\mathscr{A},M)$ (over $\C$) is a small $\C$-linear category, that is, a set $I$ (the object set) together with 
\begin{itemize}
\item[$\bullet$] for each $K=(k,l)\in I^2$ a vector space $A(K) = \Grs{A}{k}{l}=\!\!\GrDA{A}{k}{l}$ (possibly the zero vector space),
\item[$\bullet$] for each $K,L$ with $K_r = L_l$ a multiplication map \[M(K,L):A(K) \otimes A(L)\rightarrow A(K\cdot L),\qquad a\otimes b \mapsto ab\]  and 
\item[$\bullet$] elements $\Unit(k) = \Unit_k \in \Grs{A}{k}{k}$ (the units), % or the local units?
\end{itemize}
such that the obvious associativity and unit conditions are satisfied. 

By \emph{$I$-partial algebra} will be meant a partial algebra with object set $I$.
\end{Def}

\begin{Rem}We allow the local units $\Unit_k$ to be zero. %When none of the units are zero, we will call the partial algebra \emph{coconnected}. (Coconnected because we are working contravariantly: we say F(G) (the function algebra) has a property if G has that property. But a partial algebra is the `group algebra' of a linear category, so it's dual gets to be called connected, and the partial algebra itself coconnected)
\end{Rem}

Let $\mathscr{A}$ be an $I$-partial algebra. We define $A(K\wmult L)$ to be $\{0\}$ when $K\wmult L$ is ill-defined, i.e. $K_r\neq L_l$. We then let $\Grs{M}{K}{L}$ be the zero map.

\begin{Def} The \emph{total algebra} $A$ of an $I$-partial algebra $\mathscr{A}$ is the vector space \[A = \oplus_{K\in I^2} A(K)\] endowed with the unique multiplication whose restriction to $A(K)\otimes A(L)$ concides with $M(K,L)$.  
\end{Def} 
% Should a reference to the notion of locally unital algebra be given? I had a reference to Quillen, but no precise article, and I don't seem to find the link anymore...
Clearly $A$ is an associative algebra. If $I$ is infinite it will not possess a unit, but it is a \emph{locally unital algebra} as there exist mutually orthogonal idempotents $\mathbf{1}_k$ with $A = \osum{k,l} \mathbf{1}_kA\mathbf{1}_l$. An element $a\in A$ can be interpreted as a function assigning to each element $(k,l)\in I^2$ an element $a_{kl}\in A(k,l)$, namely the $(k,l)$-th component of $a$. This identifies $A$ with finite support $I$-indexed matrices whose $(k,l)$-th entry lies in $A(k,l)$, equipped with the natural matrix multiplication. 

\begin{Rem}\label{RemGrad} When $\mathscr{A}$ is an $I$-partial algebra with total algebra $A$, then $A\otimes A$ can be naturally identified with the total algebra of an $I\times I$-partial algebra $\mathscr{A}\otimes \mathscr{A}$, where \[(A\otimes A)((k,k'),(l,l')) = A(k,l)\otimes A(k',l')\] with the obvious tensor product multiplications and the $\Unit_{k,k'} = \Unit_k\otimes \Unit_{k'}$ as units. 
\end{Rem} 

%<<<<<<< HEAD
The notion of partial algebra dualizes. For this we consider again $I^2$ as the pair groupoid, but now with elements considered as column vectors, and with $\bmult$ denoting the (vertical) composition. So $K=\Grt{}{k}{l}$ has source $K_u = k$ and target $K_d = l$, and if $K=\Grt{}{k}{l}$ and $L=\Grt{}{l}{m}$ then $K\bmult L = \Grt{}{k}{m}$. 

%=======
There are two natural notions of morphism between partial algebras, functors and co-functors. %Different name? How natural are these?
% We will need the notion of \emph{relator} between partial algebras. When $R\subseteq I\times J$ is a relation, we write, for $k\in I$, $R_k= \{l'\in J\mid (k',l')\in R\}$. We write $D_R = \{k\in I\mid \#R_k\neq0\}$.  
% A \emph{functor} between an $I$-partial algebra $\mathscr{A}$ and $J$-partial algebra $\mathscr{B}$ consists of a map $F:I\rightarrow J$ and linear maps $F_{k,l}:A(k,l)\rightarrow B(F(k),F(l))$ such that the $F_{k,l}$ respect the algebra and unit maps in the obvious ways. 

% \begin{Def} A \emph{relator} between an $I$-partial algebra $\mathscr{A}$ and $J$-partial algebra $\mathscr{B}$ consists of a relation $F\subseteq I\times J$ and maps $F_{k',l'}:A(k,l)\rightarrow B(k',l')$ for $k'\in R_{k},l'\in R_{l}$ such that the following conditions hold.
% \begin{itemize}
% \item For all $k,l\in I$ and $a\in A(k,l)$, the $F_{k',l'}(a)$ are zero for almost all $k'\in R_{k}$ (resp. all $l'\in R_{l}$) when $l'$ (resp. $k'$) is fixed.  
% \item For all $a\in A(k,l)$ and $b\in A(l,m)$, and all $k'\in R_{k}, m'\in R_{m}$, one has \[F_{k',m'}(ab) = \sum_{l',l'\in R_{l}} F_{k',l'}(a)F_{l',m'}(b).\] 
% \item $F_{k',l'}(e_{k}) = \delta_{k',l'}e_{k'}$ for all $k'\in R_{k}$.  
% \end{itemize}
% \end{Def}

The notion of partial algebra dualizes. For this we consider again $I^2$ as the pair groupoid, but now with elements considered as column vectors, and with $\bmult$ denoting the (vertical) composition. So $K=\Grt{}{k}{l}$ has source $K_u = k$ and target $K_d = l$, and if $K=\Grt{}{k}{l}$ and $L=\Grt{}{l}{m}$ then $K\bmult L = \Grt{}{k}{m}$. %We write $K\bmate L$ if $K$ and $L$ are composable. 

% Then we have maps  \[\Grt{\Delta}{K}{L}: A(K\bmult L)\rightarrow A(K)\otimes A(L),\] which we interpret as zero maps when $\neg K\bmate L$. We also interpret $\Grt{\Delta}{K}{L}$ as the zero map on $A(M)$ if $M\neq K\bmult L$. The coassociativity condition can now be written  \[(\id\otimes \Grt{\Delta}{L}{M})\Grt{\Delta}{K}{L\bmult M} = ( \Grt{\Delta}{K}{L}\otimes \id)\Grt{\Delta}{K\bmult L}{M}.\]
% Should provide shortcut for notation where only the new indices appear at $\Delta$ (so disregard the source): write $\Delta(K over L)$ as $Delta_{rs}$ for $r=K_{ld}$ and $s=K_{rd}$. 
%>>>>>>> origin/master
\begin{Def} A \emph{partial coalgebra} $\mathscr{A}=(\mathscr{A},\Delta)$ (over $\C$) consists of a set $I$ (the object set) together with 
\begin{itemize}
\item[$\bullet$] for each $K=\Grru{k}{l}\in I^2$ a vector space $A(K) = \Grt{A}{k}{l}=\!\!\GrRA{A}{k}{l}$,
\item[$\bullet$] for each $K,L$ with $K_d = L_u$ a comultiplication map \[\Grt{\Delta}{K}{L}:A(K*L)\rightarrow A(K)\otimes A(L),\qquad a \mapsto a_{(1)K}\otimes a_{(2)L},\] and 
\item[$\bullet$] counit maps $\epsilon_k:\Grt{A}{k}{k}\rightarrow \C$,
\end{itemize} 
satisfying the obvious coassociativity and counitality conditions.

By \emph{$I$-partial coalgebra} will be meant a partial coalgebra with object set $I$.
\end{Def}

\begin{Not}\label{NotCom} As the index of $\epsilon_k$ is determined by the element to which it is applied, there is no harm in dropping the index $k$ and simply writing $\epsilon$.

Similarly, if $K = \Grt{}{k}{l}$ and $L = \Grt{}{l}{m}$, we abbreviate $\Delta_l = \Grt{\Delta}{K}{L}$, as the other indices are determined by the element to which $\Delta_l$ is applied.
\end{Not}

We also make again the convention that $A(K*L)=\{0\}$ and $\Grt{\Delta}{K}{L}$ the zero map when $K_d \neq L_u$. Similarly $\epsilon$ is seen as the zero functional on $A(K)$ when $K=\Grt{}{k}{l}$ with $k\neq l$. 

We can now superpose the notions of partial algebra and partial coalgebra. To formulate the condition that the coalgebra maps form a `morphism of partial algebras', we will need to impose a finiteness condition which is automatically satisfied when the cardinality of $I$ is finite.
%<<<<<<< HEAD
%=======

% Formally, a finite morphism between an $I$-partial algebra $\mathscr{A}$ and $J$-partial algebra $\mathscr{B}$ equipped with an injection $\phi$ of a subset of $J$ into $I$ consists of maps $F_{K,L}:A(\phi(K),\phi(L))\rightarrow B(K,L)$ for $K,L$ in the domain of $\phi$, such that the map $(K,L)\mapsto F_{K,L}(a)$ is finite in rows and columns when the values of $K,L$ are restricted to one fiber of$ \phi$, and such that then $F_{K,M}(ab) = \sum_L F_{K,L}(a)F_{L,M}(b)$. 
% Should this more general notion be included?
%>>>>>>> origin/master

Let $I$ be a set, and let $M_2(I)$ be the set of 4-tuples of elements of $I$ arranged as 2$\times$2-matrices. We can endow $M_2(I)$ with two compositions, namely $\cdot$ (viewing $M_2(I)$ as a row vector of column vectors) and $*$ (viewing $M_2(I)$ as a column vector of row vectors). When $K\in M_2(I)$, we will write $K = \Grs{}{K_l}{K_r} = \Grt{}{K_u}{K_d} = \eGr{}{K_{lu}}{K_{ru}}{K_{ld}}{K_{rd}}$. One can view $M_2(I)$ as a double groupoid, and in fact as a \emph{vacant} double groupoid in the sense of \cite{AN1}. 

In the following, a vector $(r,s)$ will sometimes be written simply as $r,s$ (without parentheses) or $rs$ in an index. We also follow Notation \ref{NotCom}, but the reader should be aware that the index of $\Delta$ will now be a 1$\times$2 vector in $I^2$ as we will work with partial coalgebras over $I^2$.

\begin{Def}\label{DefPartBiAlg} A \emph{partial bialgebra} $\mathscr{A}=(\mathscr{A},M,\Delta)$ consists of a set $I$ and a collection of vector spaces $A(K)$ for $K\in M_2(I)$ such that 
\begin{itemize}
\item[$\bullet$] the $\Grs{A}{K_l}{K_r}$ form an $I^2$-partial algebra,
\item[$\bullet$] the $\Grt{A}{K_u}{K_d}$ form an $I^2$-partial coalgebra,
\end{itemize} 
and for which the following compatibility relations are satisfied.
\begin{enumerate}[label=(\alph*)]
\item\label{Propa} (Comultiplication of Units) For all $k,l,m\in I$, one has 
\[\Delta_{l,l}(\UnitC{k}{m}) = \UnitC{k}{l}\otimes \UnitC{l}{m}.\]  
\item\label{Propb} (Counit of Multiplication) For all $K,L\in M_2(I)$ with $K_r = L_l$ and all $a\in A(K)$ and $b\in A(L)$, \[\epsilon(ab) = \epsilon(a)\epsilon(b).\]% Subtlety is that you already have to know composition to be able to apply this rule.
\item\label{Propc} (Non-degeneracy) For all $k\in I$, $\epsilon(\UnitC{k}{k})=1$. 
\item\label{Propd} (Finiteness) For each $K\in M_2(I)$ and each $a\in A(K)$, the element $\Delta_{rs}(a)$ is zero except for a finite number of indices $r$ (resp. $s$) when $s$ (resp. $r$) is fixed.
\item\label{Prope} (Comultiplication is multiplicative) For all $a\in A(K)$ and $b\in A(L)$ with $K_r= L_l$,  \[\Delta_{rs}(ab) = \sum_t \Delta_{rt}(a)\Delta_{ts}(b).\]
\end{enumerate}
\end{Def}

% To do: introduce notion of connectedness which should assure the trivial corepresentation is irreducible. This should correspond to the dual notion of pureness in [Bohm-Nill-Szlachanyi], i.e. to the left and right base algebras having $\C$ as intersection. This is the same as proving $\UnitC{k}{l}\neq 0$ in the presence of an antipode, since then the relation $k\sim l$ iff $\Unit{k}{l}\neq 0$ gives an equivalence relation, and fixing a non-trivial class $P$ and putting $c_k = \delta_{k\in P}, d_l = \delta_{l\in P}$, we obtain a non-trivial element $\sum_k c_k\lambda_k = \sum_l d_l \rho_l$ in the intersection.

\begin{Rem} By assumption \ref{Propd}, the sum on the right hand side in condition \ref{Prope} is in fact finite and hence well-defined. 
\end{Rem}

We want to relate the notion of partial bialgebra to the recently introduced notion of weak multiplier bialgebra \cite{Boh1}. We first recall some notions concerning non-unital algebras \cite{Dau1,VDae1}.

\begin{Def} Let $A$ be an algebra over $\C$, not necessarily with unit. We call $A$ \emph{non-degenerate} if $A$ is faithfully represented on itself by left and right multiplication. It is called \emph{idempotent} if $A^2 = A$. 
\end{Def}

\begin{Def} Let $A$ be an algebra. A \emph{multiplier} $m$ for $A$ consists of a couple of maps \begin{eqnarray*} L_m:A\rightarrow A,\quad a\mapsto ma\\ R_m:A\rightarrow A,\quad a\mapsto am\end{eqnarray*} such that $(am)b = a(mb)$ for all $a,b\in A$. 

The set of all multipliers forms an algebra under composition for the $L$-maps and anti-composition for the $R$-maps. It is called the \emph{multiplier algebra} of $A$, and is denoted $M(A)$.
\end{Def}

One has a natural homomorphism $A\rightarrow M(A)$. When $A$ is non-degenerate,  this homomorphism is injective, and we can then identify $A$ as a subalgebra of the (unital) algebra $M(A)$. We then also have inclusions \[A\otimes A\subseteq M(A)\otimes M(A)\subseteq M(A\otimes A).\]

\begin{Exa}\label{ExaMult} \begin{enumerate}
\item Let $A$ be the total algebra of an $I$-partial algebra $\mathscr{A}$. As $A$ has local units, it is non-degenerate and idempotent. Then one can identify $M(A)$ with \[M(A) = \left(\prod_l \oplus_k A(k,l)\right) \bigcap \left(\prod_k\oplus_l A(k,l)\right) \subseteq \prod_{k,l} A(k,l),\] i.e. with the space of functions \[m:I^2\rightarrow A,\quad m_{kl}\in A(k,l)\] which have finite support in either one of the variables when the other variable has been fixed. The multiplication is given by the formula \[(mn)_{kl} = \sum_p m_{kp}n_{pl}.\]
\item Let $m_i$ be any collection of multipliers of $A$, and assume that for each $a\in A$, $m_ia =0$ for almost all $i$, and similarly $am_i=0$ for almost all $i$. Then one can define a multiplier $\sum_i m_i$ in the obvious way by termwise multiplication. One says that the sum $\sum_i m_i$ converges in the \emph{strict} topology. 
\end{enumerate}
\end{Exa}

Using the notion introduced in Example \ref{ExaMult}.2, we can introduce the following notation.

\begin{Not}
If $\mathscr{A}$ is an $I$-partial bialgebra, we write \[\lambda_k = \sum_l \UnitC{k}{l},\qquad \rho_l = \sum_k\UnitC{k}{l} \qquad \in M(A).\]
\end{Not}

\begin{Rem} From Property \ref{Propc} of Definition \ref{DefPartBiAlg}, it follows that $\lambda_k\neq 0\neq \rho_k$ for any $k\in I$. 
\end{Rem} 

To show that the total algebra of a partial bialgebra becomes a weak multiplier bialgebra, we will need some easy lemmas. 

\begin{Lem} Let $\mathscr{A}$ be an $I$-partial bialgebra. Then for each $a\in A$, there exists a unique multiplier $\Delta(a) \in M(A\otimes A)$ such that \begin{align}\label{EqDel}
    \begin{aligned}
      \Delta_{rs}(a) &= (1\otimes \lambda_r)\Delta(a)(1\otimes
      \lambda_s) \\ &= (\rho_r\otimes 1)\Delta(a)(\rho_s\otimes 1)
    \end{aligned}
\end{align}  for all $r,s\in I$, all $K\in M_2(I)$ and all $a\in A(K)$. 

The resulting map \[\Delta:A\rightarrow M(A\otimes A),\quad a\mapsto \Delta(a)\] is a homomorphism.
\end{Lem}
\begin{proof} For $a\in A$ homogeneous, we can define $\Delta(a) = \sum_{rs} \Delta_{rs}(a) \in M(A\otimes A)$, where the sum converges in the strict topology of $A\otimes A$ because of the property \ref{Propd} of Definition \ref{DefPartBiAlg}. This expression clearly satisfies the identities stated in the lemma. In turn, these identities uniquely define $\Delta(a)$ as a multiplier, as they determine the value of $\Delta(a)$ when cut down to the left and right with the local units of $\mathscr{A}\otimes \mathscr{A}$.

We can then extend $\Delta$ to $A$ by linearity. Since, for $a,b$ homogeneous, $\Delta_{rt}(a)\Delta_{t's}(b)=0$ unless $t=t'$, it follows from property \ref{Prope} of Definition \ref{DefPartBiAlg} that $\Delta$ is a homomorphism. 
\end{proof}

We will refer to $\Delta: A\rightarrow M(A\otimes A)$ as the \emph{total comultiplication} of $\mathscr{A}$. We will then also use the suggestive Sweedler notation for this map, \[\Delta(a) = a_{(1)}\otimes a_{(2)}.\] Note for example that \[\Delta(\UnitC{k}{m}) = \sum_{l}\UnitC{k}{l}\otimes \UnitC{l}{m} = \sum_l \lambda_k\rho_l\otimes \lambda_l\rho_m.\]

\begin{Lem} The element $E = \sum_{k,l,m} \UnitC{k}{l}\otimes \UnitC{l}{m}= \sum_l \rho_l\otimes \lambda_l$ is a well-defined idempotent in $A\otimes A$, and satisfies \[\Delta(A)(A\otimes A)=E(A\otimes A),\quad (A\otimes A)\Delta(A)= (A\otimes A)E.\]
\end{Lem} 
\begin{proof} Clearly the sum defining $E$ is strictly convergent, and makes $E$ into an idempotent. It is moreover immediate that $E\Delta(a)=\Delta(a) = \Delta(a)E$ for all $a\in A$. Since \[E(\UnitC{k}{l}\otimes \UnitC{m}{n}) = \Delta(\UnitC{k}{n})(\UnitC{k}{l}\otimes \UnitC{m}{n}) \] by the property \ref{Propa} of Definition \ref{DefPartBiAlg}, and analogously for multiplication with $E$ on the right, the lemma is proven. 
\end{proof} 

By \cite[Proposition A.3]{VDW2}, there is a unique homomorphism $\Delta:M(A)\rightarrow M(A\otimes A)$ extending $\Delta$ and such that $\Delta(1) = E$. Alternatively, if $m\in M(A)$, we can directly define $\Delta(m)$ as the strict limit of the series $\sum_{k,l,r,s} \Delta_{rs}(m_{kl})$. Similarly the maps $\id\otimes \Delta$ and $\Delta\otimes \id$ extend to maps from $M(A\otimes A)$ to $M(A\otimes A\otimes A)$. 

For example, note that
\begin{align} \label{eq:delta-lambda-rho} \Delta(\lambda_{k}) &=
  (\lambda_{k} \otimes 1)\Delta(1), & \Delta(\rho_{m}) &= (1 \otimes \rho_{m})\Delta(1).
\end{align}

The following proposition gathers the properties of $\Delta$, $\epsilon$ and $\Delta(1)$ which guarantee that $(A,\Delta)$ forms a weak multiplier bialgebra in the sense of \cite[Definition 2.1]{Boh1}.

\begin{Prop} Let $\mathscr{A}$ be a partial bialgebra with total algebra $A$, total comultiplication $\Delta$ and counit $\epsilon$. Then the following properties are satisfied.
\begin{enumerate}[label={(\arabic*)}]
\item Coassociativity: $(\Delta\otimes \id)\Delta = (\id\otimes \Delta)\Delta$ (as maps $M(A)\rightarrow M(A^{\otimes 3})$).
\item Counitality: $(\epsilon\otimes \id)(\Delta(a)(1\otimes b)) = ab = (\id\otimes \epsilon)((a\otimes 1)\Delta(b))$ for all $a,b\in A$.
\item Weak Comultiplicativity of Unit: \[(\Delta(1)\otimes 1)(1\otimes \Delta(1)) = (\Delta\otimes \id)\Delta(1) = (\id\otimes \Delta)\Delta(1) = (1\otimes \Delta(1))(\Delta(1)\otimes 1).\]
\item \label{WMC} Weak Multiplicativity of Counit: For all $a,b,c\in A$, one has \[(\epsilon\otimes \id)(\Delta(a)(b\otimes c)) = (\epsilon\otimes \id)((1\otimes a)\Delta(1)(b\otimes c))\] and 
\[(\epsilon\otimes \id)((a\otimes b)\Delta(c)) = (\epsilon\otimes \id)((a\otimes b)\Delta(1)(1\otimes c)).\]
\item Strong multiplier property: For all $a,b\in A$, one has \[\Delta(A)(1\otimes A)\cup (A\otimes 1)\Delta(A)\subseteq  A\otimes A.\] 
\end{enumerate}
\end{Prop}

\begin{proof} Most of these properties follow immediately from the definition of a partial bialgebra. For demonstrational purposes, let us check the first identity of property \ref{WMC}. Let us choose $a\in A(K)$, $b\in A(L)$ and $c\in A(M)$. Then \[\Delta(a)(b\otimes c) = \delta_{K_{ru},L_{lu}}\delta_{M_{lu},L_{ld}} \sum_r \Delta_{r,L_{ld}}(a)(b\otimes c).\]  Applying $(\epsilon\otimes \id)$ to both sides, we obtain by Proposition \ref{Propb} of Definition \ref{DefPartBiAlg} and counitality of $\epsilon$ that \[(\epsilon \otimes \id)(\Delta(a)(b\otimes c)) = \delta_{K_{ru},L_{lu},L_{ld},M_{lu}} \epsilon(b) ac.\] On the other hand, \begin{eqnarray*} (1\otimes a)\Delta(1)(b\otimes c) &=& \sum_{r,s,t} \UnitC{r}{s} b \otimes a\UnitC{s}{t}c \\ &=& \delta_{L_{ld},K_{ru},M_{lu}} b \otimes ac.\end{eqnarray*} Applying $(\epsilon\otimes \id)$, we find \begin{eqnarray*} (\epsilon\otimes \id)( (1\otimes a)\Delta(1)(b\otimes c) ) &=&  \delta_{L_{ld},K_{ru},M_{lu}}\delta_{L_{lu},L_{ld}}\delta_{L_{ru},L_{rd}} \epsilon(b)ac \\ &=&  \delta_{L_{ld},L_{lu},K_{ru},M_{lu}} \epsilon(b)ac,\end{eqnarray*} which agrees with the expression above.
\end{proof} 

\begin{Rem} 
Since also the expressions $\Delta(a)(b\otimes 1)$ and $(1\otimes a)\Delta(b)$ are in $A\otimes A$ for all $a,b\in A$, we see that $(A,\Delta)$ is in fact a \emph{regular} weak multiplier bialgebra \cite[Definition 2.3]{Boh1}.
\end{Rem} 

% Need to give a converse of the theorem, show that any weak multiplier bialgebra with object algebra $F_f(I)$ is of the above form?

Recall from \cite[Section 3]{Boh1} that a regular weak multiplier
bialgebra admits four projections $A\rightarrow M(A)$, given
by \begin{align*} \bar{\Pi}^L(a) = (\epsilon\otimes \id)((a\otimes
  1)\Delta(1)),\quad & \bar{\Pi}^R(a) = (\id\otimes
  \epsilon)(\Delta(1)(1\otimes a)),\\ \Pi^L(a) = (\epsilon\otimes
  \id)(\Delta(1)(a\otimes 1)),\quad& \Pi^R(a) =
  (\id\otimes\epsilon)((1\otimes a)\Delta(1)),\end{align*} where the
right hand side expressions are interpreted as multipliers in the
obvious way. The relation  $\Delta(1)=\sum_{p} \rho_{p} \otimes \lambda_{p}$ and  condition (c) in Definition \ref{DefPartBiAlg} imply
\begin{align*}
  \bar \Pi^{L}(A) &=\mathrm{span}\{\lambda_{p}:p\in I\} =  \Pi^{L}(A), &
  \bar \Pi^{R}(A) &= \mathrm{span}\{\rho_{p}:p\in I\} =\Pi^{R}(A).
\end{align*}
The \emph{base algebra} of $(A,\Delta)$ is therefore just the algebra
$\Fun_{\fin}(I)$ of finite support functions on $I$, and the
comultiplication of $A$ is (left and right) \emph{full} (meaning
roughly that the legs of $\Delta(A)$ span $A$) by \cite[Theorem
3.13]{Boh1}.  

 The maps $\Pi^{L}$ and $\Pi^{R}$ can also
be written in the form
\begin{align} \label{eq:pi} 
    \Pi^L(a) & = \sum_{p}\epsilon(\lambda_{p}a)\lambda_p, & \Pi^R(a) & =    \sum_{p}\epsilon(a \rho_{p}) \rho_p
\end{align}
because $\epsilon(\lambda_{k}\rho_{m} a \lambda_{l}\rho_{n})=0$  if $(k,l)\neq(m,n)$. These relations and  \eqref{EqDel}, \eqref{eq:delta-lambda-rho} imply
\begin{align} \label{eq:pi-l-delta}
  (\Pi^{L} \otimes \id)(\Delta(a)) &= \sum_{p} \lambda_{p}\otimes \lambda_{p}a, &
  (\id \otimes \Pi^{L})(\Delta(a)) &= \sum_{p} \rho_{p}a \otimes \lambda_{p}, & \\ \label{eq:pi-r-delta}
  (\Pi^{R} \otimes \id)(\Delta(a)) &= \sum_{p} \rho_{p} \otimes a\lambda_{p}, &
  (\id \otimes \Pi^{R})(\Delta(a)) &= \sum_{p} a\rho_{p} \otimes \rho_{p}.
\end{align}

We now formulate the notion of partial Hopf algebra, whose total form will correspond to a weak multiplier Hopf algebra \cite{Boh1,VDW2,VDW1}. We will mainly refer to \cite{Boh1} for uniformity.

 Let us denote $\circ$ for the inverse of $\wmult$, and $\bullet$ for the inverse of $\bmult$, so \[\begin{pmatrix} k & l \\ m & n \end{pmatrix}^{\circ} = \begin{pmatrix} l & k \\ n & m \end{pmatrix},\quad \begin{pmatrix} k & l \\ m & n \end{pmatrix}^{\bullet} = \begin{pmatrix} m & n \\ k & l \end{pmatrix},\quad \begin{pmatrix} k & l \\ m & n \end{pmatrix}^{\circ \bullet} = \begin{pmatrix} n & m \\ l & k \end{pmatrix}.\] The notation $\circ$ (resp. $\bullet$) will also be used for row vectors (resp. column vectors).

\begin{Def}\label{DefPartBiAlgAnt} An \emph{antipode} for an
  $I$-partial bialgebra $\mathscr{A}$ consists of linear
maps \[S:A(K)\rightarrow A(K^{\circ\bullet})\]
  such that the following property holds: for all $M,P\in M_2(I)$ and
  all $a\in A(M)$, \begin{align} \label{eq:antipode-pi-l}\underset{K\wmult
      L^{\circ\bullet}=P}{\sum_{K\bmult L = M}} a_{(1)K}S(a_{(2)L})&=
    \delta_{P_l,P_r}\epsilon(a)\mathbf{1}(P_l),
    \\ \label{eq:antipode-pi-r}
    \underset{K^{\circ\bullet}\wmult L=P}{\sum_{K\bmult L = M}}
    S(a_{(1)K})a_{(2)L}&=
    \delta_{P_l,P_r}\epsilon(a)\mathbf{1}(P_r).\end{align}

A partial bialgebra $\mathscr{A}$ is called a \emph{partial Hopf algebra} if it admits an antipode.
\end{Def} 

\begin{Rem} Note that condition \ref{Propd} of Definition \ref{DefPartBiAlg} again guarantees that the above sums are in fact finite.
\end{Rem}

If $S$ is an antipode for a partial bialgebra, we can extend $S$ to a
linear map \[S:A\rightarrow A\] on the total algebra $A$.  Conditions
\eqref{eq:antipode-pi-l} and \eqref{eq:antipode-pi-r} then take the
following simple form:
\begin{Lem} \label{lemma:antipode}
  A family of maps $S \colon A(K) \to A(K^{\circ\bullet})$ satisfies
  \eqref{eq:antipode-pi-l} and \eqref{eq:antipode-pi-r} if and only if
  the total map $S\colon A \to A$ satisfies 
  \begin{align} \label{eq:total-antipode}
 a_{(1)}S(a_{(2)}) &= \Pi^{L}(a), &
 S(a_{(1)})a_{(2)} &= \Pi^{R}(a)
  \end{align}
for all $a\in A$.
\end{Lem}

Note that these should be considered a priori as equalities of left (resp. right) multipliers on $A$.

\begin{proof}
For $M,P\in M_{2}(I)$ and $a\in A(M)$, the left and the right hand side  of \eqref{eq:antipode-pi-l} are the $P$-homogeneous components of $ a_{(1)}S(a_{(2)})$ and $\Pi^{L}(a)=\sum_{p} \epsilon(\lambda_{p}a)\lambda_{p}$, respectively.
\end{proof}

\begin{Lem}\label{LemAntiUnit} Let $\mathscr{A}$ be a partial Hopf algebra with antipode $S$. For all $k,l\in I$, $S(\UnitC{k}{l}) = \UnitC{l}{k}$.
\end{Lem}
\begin{proof} For example the first identity in Equation \eqref{eq:total-antipode} of Lemma \ref{lemma:antipode} applied to $\UnitC{k}{k}$ gives \[\sum_l S(\UnitC{l}{k}) = \sum_l \UnitC{k}{l}S(\UnitC{l}{k}) = \lambda_k,\] as $S(\UnitC{l}{k}) \in \Gr{A}{k}{k}{l}{l}$ and $\Pi^{L}(\UnitC{k}{k}) = \lambda_k$. This implies the lemma.
\end{proof} 

The existence of an antipode is closely related to partial invertibility of
the maps $T_{1},T_{2} \colon A \otimes A \to A\otimes A$ given by
\begin{align} \label{eq:wt-12}
  T_{1} (a\otimes b)&= \Delta(a)(1 \otimes b), &
  T_{2} (a\otimes b)&= (a \otimes 1)\Delta(b).
 \end{align}
The precise formulation involves the linear maps $E_{i},G_{i}
 \colon A\otimes A\to A\otimes A$ given by
\begin{align} \label{eq:e1g1}
  G_{1}(a\otimes b) &=
 \sum_{p} a\rho_{p} \otimes \rho_{p}b, &  E_{1}(a \otimes b) &=E(a\otimes b)=\sum_{p} \rho_{p}a\otimes \lambda_{p}b, \\ \label{eq:e2g2}
 G_{2}(a \otimes b) &= \sum_{p} a\lambda_{p} \otimes
    \lambda_{p}b, &
E_{2}(a\otimes b) &= (a\otimes b)E=\sum_{p} a\rho_{p} \otimes b\lambda_{p}.
\end{align}
\begin{Prop} \label{prop:riti}
  Let $\mathscr{A}$ be a partial Hopf algebra with total algebra $A$,
  total comultiplication $\Delta$ and antipode  $S$. Then the maps
  $R_{1},R_{2} \colon A \otimes A \to M(A \otimes A)$ given by
  \begin{align*}
    R_{1}(a \otimes b) &= a_{(1)}\otimes S(a_{(2)})b, &
    R_{2}(a\otimes b) &= aS(b_{(1)})\otimes b_{(2)}
  \end{align*}
  take values in $A\otimes A$ and satisfy for $i=1,2$ the relations
  \begin{align} \label{eq:riti}
    T_{i}R_{i}&=E_{i}, & R_{i}T_{i}&= G_{i}, & T_{i}R_{i}T_{i}&= T_{i}, & R_{i}T_{i}R_{i} &= R_{i}.
  \end{align}
\end{Prop}
\begin{proof}
  The map $R_{1}$ takes values in $A\otimes A$ because
  \begin{align*}
  a_{(1)} \otimes
  S(a_{(2)})\lambda_{k}\rho_{l} =  a_{(1)} \otimes S(\rho_{l}\lambda_{k}a_{(2)}) \in A
  \otimes A
  \end{align*}
  for all $a\in A$, and Lemma
  \ref{lemma:antipode},  Equation \eqref{eq:pi-l-delta} and Lemma \ref{LemAntiUnit} imply
  \begin{align*}
    T_{1}R_{1}(a \otimes b)&= a_{(1)} \otimes a_{(2)}S(a_{(3)})b =
    a_{(1)} \otimes \Pi^{L}(a_{(2)})b =
    \sum_{p} \rho_{p}a \otimes \lambda_{p}b, \\
    R_{1}T_{1}(a \otimes b) &= a_{(1)} \otimes S(a_{(2)})a_{(3)}b =
    a_{(1)} \otimes \Pi^{R}(a_{(2)})b = \sum_{p} a\rho_{p}\otimes
    \rho_{p}b.
  \end{align*}
 The relations $T_{1}R_{1}T_{1}=T_{1}$ and
$R_{1}T_{1}R_{1}=R_{1}$ follow easily from  \eqref{EqDel} and
\eqref{eq:delta-lambda-rho}. The assertions concerning $R_{2}$ and
$T_{2}$ follow similarly.
\end{proof}
\begin{Theorem}  \label{theorem:partial-hopf-algebra}
  Let $\mathscr{A}$ be a partial bialgebra with total algebra $A$,
  total comultiplication $\Delta$ and counit $\epsilon$. Then the
  following conditions are equivalent:
  \begin{enumerate}[label={(\arabic*)}]
  \item\label{tph1} $\mathscr{A}$ is a partial Hopf algebra.
  \item\label{tph2} There exist linear maps $R_{1},R_{2} \colon A\otimes A\to
    A\otimes A$ satisfying  \eqref{eq:riti}.
  \item\label{tph3} $(A,\Delta,\epsilon)$  is a regular weak multiplier Hopf algebra in the sense of \cite{VDW1}.
  \end{enumerate}
  If these conditions hold, then the total  antipode of $\mathscr{A}$ coincides with the antipode of $(A,\Delta,\epsilon)$.
\end{Theorem}
\begin{proof}
\ref{tph1} implies \ref{tph2} by Proposition \ref{prop:riti}. \ref{tph2} is equivalent to \ref{tph3} by Definition
1.14 in \cite{VDW1}. Indeed, the maps $G_{1},G_{2}$ defined in \eqref{eq:e1g1} and \eqref{eq:e2g2} satisfy
\begin{align*}
  G_{1}(a_{(1)} \otimes b) \otimes a_{(2)}c &= \sum_{p} a_{(1)} \otimes \rho_{p}b
  \otimes a_{(2)}\lambda_{p}c, \\
  ac_{(1)} \otimes G_{2}(b\otimes c_{(2)}) &=\sum_{p} a\rho_{p}c_{(1)} \otimes b\lambda_{p} \otimes c_{(2)}
\end{align*}
and therefore coincide with the maps introduced in Proposition 1.14 in
\cite{VDW1}.  Finally, assume \ref{tph3}. Then
 Lemma 6.14 and equation (6.14) in \cite{Boh1} imply that the antipode
$S$ of $(A,\Delta)$ satisfies $S(A(K))\subseteq A(K^{\circ\bullet})$ and relation \eqref{eq:total-antipode}.  Now, Lemma \ref{lemma:antipode} implies \ref{tph1}.
\end{proof}

From \cite[Proposition 3.5 and Proposition 3.7]{VDW1} or \cite[Theorem
6.12 and Corollary 6.16]{Boh1}, we can conclude that the antipode of a
partial Hopf algebra reverses the multiplication and
comultiplication. Denote by $\Delta^{\op}$ the composition of
$\Delta$ with the flip map.

\begin{Cor} \label{corollary:antipode} Let $\mathscr{A}$ be a partial
  Hopf algebra. Then the total antipode $S:A\rightarrow A$ satisfies
  $S(ab) = S(b)S(a)$ and $\Delta(S(a)) = (S\otimes S)\Delta^{\op}(a)$
  for all $a,b\in A$. In particular, $S(\UnitC{k}{m})=\UnitC{m}{k}$
  for all $k,m\in I$ if $S$ is bijective. \texttt{need for
    corepresentations somewhere that $\epsilon \circ
    S = \epsilon$}
\end{Cor} 
We now turn towards the structures which will allow us to build operator algebraic quantum groupoids out of our partial Hopf algebras.

\begin{Def} A \emph{partial $^*$-algebra} $\mathscr{A}$ is a partial
  algebra whose total algebra $A$ is equipped with an antilinear,
  antimultiplicative involution $*\colon A\rightarrow A$, $ a\mapsto
  a^*$,  such that the $\mathbf{1}_k$ are selfadjoint for all $k$ in
  the object set. 
\end{Def} 

One can of course give an alternative definition directly in terms of the partial algebra structure by requiring that we are given antilinear maps $A(k,l)\rightarrow A(l,k)$ satisfying the obvious antimultiplicativity and involution properties.

\begin{Def} A \emph{partial $^*$-bialgebra} $\mathscr{A}$ is a
 partial bialgebra whose underlying partial algebra has been
  endowed with a partial $^*$-algebra structure such that
$\Delta(a)^* = \Delta(a^*)$ for all $a \in A$.
A \emph{partial Hopf $^*$-algebra} is a partial bialgebra which is at the same time a partial $^*$-bialgebra and a partial Hopf algebra.
\end{Def} 
Thus, a partial bialgebra is a partial
$*$-bialgebra if and only if the underlying weak multiplier bialgebra
 is a weak multiplier $*$-bialgebra.

From Theorem \ref{theorem:partial-hopf-algebra} and \cite{Boh1},
\cite{VDW1}, we can deduce:
\begin{Cor}
  An $I$-partial $^*$-bialgebra $\mathscr{A}$ is an $I$-partial Hopf
  $^*$-algebra if and only if the weak multiplier $^*$-bialgebra
  $(A,\Delta)$ is a weak multiplier Hopf $^*$-algebra. In that case,
  the counit and antipode satisfy
  $\epsilon(a^{*})=\overline{\epsilon(a)}$ and $S(S(a)^{*})^{*}=a$ for
  all $a\in A$. In particular, the total antipode is bijective.
\end{Cor}
\begin{proof}
  The if and only if part follows immediately from  Theorem
  \ref{theorem:partial-hopf-algebra}, the relation for the counit  from
uniqueness of the counit  \cite[Theorem 2.8]{Boh1}, and the relation
for the antipode from \cite[Proposition 4.11]{VDW1}.
\end{proof}

\begin{Def}
  Let $\mathscr{A}$ be an $I$-partial bialgebra.  We call a family of
  functionals
\begin{align} \label{eq:functionals}
  \phic{k}{m} \colon A\pmat{k}{k}{m}{m} \to \C
\end{align}
a \emph{left invariant} \emph{integral} if
 $\phic{k}{k}(\UnitC{k}{k})=1$ for all $k\in
I$ and
\begin{align}
  \label{eq:integral}
   (\id \otimes \phic{l}{m})(\Delta_{l,l}(a)) 
&= \delta_{k,p} \phic{k}{m}(a)
  \UnitC{k}{l} 
\end{align}
 for all $k,l,m,p\in I$, $a \in A\pmat{k}{p}{m}{m}$. 
 
 We call them a \emph{right invariant}  \emph{integral} if instead one has \begin{align}
  (\phic{k}{l} \otimes
  \id)(\Delta_{l,l}(a))&= \delta_{m,p} \phic{k}{m}(a) \UnitC{l}{m}\end{align}
 for all $k,l,m,p\in I$, $a \in A\pmat{k}{k}{m}{p}$. 
 
 If $\phi$ is a left
 and a right invariant integral, we call $\phi$ an \emph{invariant integral}.
\end{Def}
\begin{Lem}
  \begin{enumerate}[label={(\arabic*)}]
  \item\label{LI1} If $\phi$ is a left or right invariant integral, then
    $\phic{k}{m}(\UnitC{k}{m})=1$ for all $k,m\in I$ with $\UnitC{k}{m}\neq 0$.
  \item\label{LI2} If a left integral and a right invariant integral exist, then the two
    are equal and unique.
  \item\label{LI3} Assume that $\mathscr{A}$ is an $I$-partial Hopf algebra with
    bijective antipode $S$.  If $\phi$ is a left or right invariant integral,
    then it is unique, an invariant integral, and equal to $\phi\circ S$.
    \end{enumerate}
\end{Lem}
\begin{proof}
To see \ref{LI1}, take  $a=\UnitC{k}{k}$ in \eqref{eq:integral}. For \ref{LI2},
assume that $\phi$ and $\psi$ are a  left and a
 right invariant integral.     Then for all $k,l,m\in I$, $a\in A\pmat{k}{k}{m}{m}$,
    \begin{align*}
      \phic{k}{m}(a)  &= (\Grt{\psi}{k}{k} \otimes
      \phic{k}{m})(\Delta_{k,k}(a)) = \Grt{\psi}{k}{m}(a)\Grt{\phi}{k}{m}(\UnitC{k}{m}) = \Grt{\psi}{k}{m}(a) .
    \end{align*}
To prove \ref{LI3}, assume that $\phi$ is a left or right invariant integral. Then
Corollary \ref{corollary:antipode} implies that $\phi\circ S$ is a
right or left invariant integral, and \ref{LI2} implies the claim.
\end{proof}
Given a family of functionals as in \eqref{eq:functionals}, we denote
by $\phi \colon A \to \C$ the corresponding functional on the total
algebra.

We are finally ready to formulate our main definition.
\begin{Def} A \emph{partial compact quantum group} $\mathscr{G}$ is a
  partial Hopf $^*$-algebra $\mathscr{A} = P(\mathscr{G})$ with an invariant integral  $\phi$ that is positive in the sense  that $\phi(a^*a)\geq 0$ for all $a\in A$. We also say that $\mathscr{G}$ is the partial compact quantum group \emph{defined by} $\mathscr{A}$.
\end{Def} 

\begin{Rem} Following \cite{Hay1}, we could also have called our objects \emph{compact quantum groups of face type}, but we feel this gives the wrong impression when the base algebra is infinite dimensional (i.e. the object set is not compact). When referring to partial compact quantum groups, we feel that it is better reflected that only the \emph{parts} of this object are to be considered compact, not the total object. % Is this a clear enough motivation? 
\end{Rem} 

The total form of the invariance conditions
\eqref{eq:integral}  reads as follows. 
\begin{Lem} \label{lemma:total-integral}
  A family of functionals $\phi$ as in   \eqref{eq:functionals}
  satisfies the conditions in \eqref{eq:integral} if and only if
for all $a\in A$,
  \begin{align*}
(\phi\otimes \id)(\Delta(a)(1\otimes b)) &= \sum_{n}
\phi(\rho_{n} a)\rho_n b
&& \big(\text{or} &
(\id\otimes \phi)((b\otimes 1)\Delta(a)) &= \sum_{k}\phi(\lambda_{k}a)b\lambda_k.\big)
      \end{align*}
\end{Lem}
\begin{proof}
  Straightforward.
\end{proof}


We will need the following lemma at some point, which is an almost verbatim transcription of the argument in \cite[Proposition 3.4]{VDae2}.

\begin{Lem}\label{LemFaith} Let $\mathscr{A}$ be a partial Hopf
  algebra with bijective antipode and an integral $\phi$. Then
  $\phi$ is faithful in the following sense: if $a\in A$ and
  $\phi(ab) =0$ (resp. $\phi(ba)=0$) for all $b\in A$, then
  $a=0$.
\end{Lem} 
% Ref to Timmermann for case of quantum groupoids? Can be explicitly used here? Ask Fons if he has already derived this result, and acknowledge? 
\begin{proof} Suppose  $\phi(ba)=0$ for all $b$. Then for all $d\in A$ and all functionals $\omega$ on $A$, the element $p = (\omega\otimes \id)((d\otimes 1)\Delta(a))$ satisfies \[(\id\otimes \phi)((1\otimes c)\Delta(p)) = 0.\] Continuing as in the proof of \cite[Proposition 3.4]{VDae2}, we obtain from the antipode trick that \[\sum_n \phi(cS(q)\rho_n)\epsilon(p\lambda_n)=0.\] Choosing now for $c$ and $q$ local units of the form $\lambda_k\rho_l$, the normalization condition on $\phi$ gives that $\epsilon(p\lambda_n)=0$ for all $n$, hence $\epsilon(p)=0$. This implies $\omega(da)=0$. As $\omega$ and $d$ were arbitrary, it follows that $a=0$.

The other case follows similarly, or by considering the opposite comultiplication.
\end{proof} 

\begin{Lem} \label{lemma:strong-invariance}
  Let $\mathscr{A}$ be a partial Hopf algebra with  integral $\phi$. Then
  for all $a\in A$,
  \begin{align*}
    (\id \otimes \phi)((1 \otimes b)\Delta(a)) &= (S \otimes
    \phi)(\Delta(b)(1 \otimes a)), \\
    (\phi \otimes \id)(\Delta(a)(b \otimes 1)) &= (\phi \otimes
    S)(\Delta(a)(1\otimes b)).
  \end{align*}
\end{Lem}
\begin{proof}
 The counit property, the relations \eqref{EqDel} and
 \eqref{eq:total-antipode} and Lemma \ref{lemma:total-integral} imply
  \begin{align*}
    a_{(1)}\phi(ba_{(2)}) &= \sum_{n}
    a_{(1)}\phi(\epsilon(b_{(1)}\rho_{n})b_{(2)}\lambda_{n}a_{(2)}) \\
&= \sum_{n} \epsilon(b_{(1)}\rho_{n})\rho_{n}a_{(1)}\phi(b_{(2)}a_{(2)})
\\
&= S(b_{(1)})b_{(2)}a_{(1)}\phi(b_{(3)}a_{(2)}) =
S(b_{(1)})\phi(b_{(2)}a)
  \end{align*}
for all $a,b \in A$. The second equation 
follows similarly.
\end{proof}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "dyn-suq-main"
%%% End: 
